<app-headear></app-headear>

<div class="agendamentos-container">
  <h2>Controle de Agendamentos</h2>

  <!-- Botões de ação -->
  <div class="agendamentos-header">
    <button class="btn-voltar" (click)="voltarHome()">← Voltar</button>
    <button class="btn-proximos" (click)="agendamentosProximos()">📍 Agendamentos próximos</button>
    <button class="btn-todos" (click)="mostrarTodosAgendamentos()">Mostrar todos</button>
  </div>

  <!-- Filtros -->
  <div class="filtros">
    <input type="text" placeholder="Filtrar por Doadora" [(ngModel)]="filtroDoadora" />
    <input type="text" placeholder="Filtrar por Banco de Leite" [(ngModel)]="filtroBanco" />
    <select [(ngModel)]="filtroStatus">
      <option value="">Todos os Status</option>
      <option value="Pendente">Pendente</option>
      <option value="Aceito">Aceito</option>
      <option value="Recusado">Recusado</option>
      <option value="Reagendamento Solicitado">Reagendamento Solicitado</option>
    </select>
    <select [(ngModel)]="ordenarData">
      <option value="recentes">Mais recentes</option>
      <option value="antigas">Mais antigas</option>
    </select>
  </div>

  <!-- Cards de agendamentos -->
  <div class="cards">
    <div class="card-agendamento" *ngFor="let agendamento of agendamentosFiltrados()"
         [ngClass]="{
           'pendente': agendamento.status === 'Pendente',
           'aceito': agendamento.status === 'Aceito',
           'recusado': agendamento.status === 'Recusado',
           'reagendamento': agendamento.status === 'Reagendamento Solicitado'
         }">
      <h3>{{ agendamento.nome_doadora }}</h3>
      <p><strong>Status:</strong> {{ agendamento.status }}</p>
      <p><strong>Data:</strong> {{ formatarData(agendamento.data_agendamento) }}</p>
      <p><strong>Banco:</strong> {{ agendamento.bancoDeLeite }}</p>
      <p><strong>ML:</strong> {{ agendamento.quantidade_ml }} ml</p>
      <p><strong>Endereço:</strong> {{ agendamento.rua || '-' }}, {{ agendamento.numero || '-' }}, {{ agendamento.bairro || '-' }}</p>

      <div class="acoes-card">
        <button class="acao-btn aceitar" (click)="aceitar(agendamento.id)">Aceitar</button>
        <button class="acao-btn recusar" (click)="recusar(agendamento.id)">Recusar</button>
      </div>

      <div class="reagendamento-card">
        <input type="datetime-local" [(ngModel)]="novaDataReagendamento[agendamento.id]" />
        <button class="acao-btn reagendar" (click)="reagendar(agendamento.id)">Reagendar</button>
      </div>
    </div>
  </div>
</div>
